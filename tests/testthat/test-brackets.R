
context("colour_brackets")

test_that("bracket highlighting", {
  
  # [](){}
  expect_equal(
    color_brackets(c("[", "]", "(", ")", "{", "}")),
    c(
      "\033[33m[\033[39m",
      "\033[33m]\033[39m",
      "\033[33m(\033[39m",
      "\033[33m)\033[39m",
      "\033[33m{\033[39m",
      "\033[33m}\033[39m"
    )
  )
  
  # [({[({})]})]
  expect_equal(
    color_brackets(c(
      "[", "(", "{", "[", "(", "{", "}", ")", "]", "}", ")", "]"
    )),
    c(
      "\033[33m[\033[39m",
      "\033[34m(\033[39m",
      "\033[36m{\033[39m",
      "\033[33m[\033[39m",
      "\033[34m(\033[39m",
      "\033[36m{\033[39m",
      "\033[36m}\033[39m",
      "\033[34m)\033[39m",
      "\033[33m]\033[39m",
      "\033[36m}\033[39m",
      "\033[34m)\033[39m",
      "\033[33m]\033[39m"
    )
  )
  
  # [[ [] ]][[ ()() ]]
  expect_equal(
    color_brackets(c(
      "[[", "[", "]", "]", "]", "[[", "(", ")", "(", ")", "]", "]"
    )),
    c(
      "\033[33m[[\033[39m",
      "\033[34m[\033[39m",
      "\033[34m]\033[39m",
      "\033[33m]\033[39m",
      "\033[33m]\033[39m",
      "\033[33m[[\033[39m",
      "\033[34m(\033[39m",
      "\033[34m)\033[39m",
      "\033[34m(\033[39m",
      "\033[34m)\033[39m",
      "\033[33m]\033[39m",
      "\033[33m]\033[39m"
    )
  )
})
